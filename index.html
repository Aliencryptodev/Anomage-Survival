<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<title>Anoma Survival</title>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<style>
  :root { --ui-bg: rgba(0,0,0,.55); --ui-pill:#0b1220; --ui-border:#3b4252; }
  html,body{height:100%;margin:0;background:#0e0f13;color:#e6ebef;font:14px/1.2 system-ui,Segoe UI,Roboto,Arial}
  #topbar{position:fixed;left:0;right:0;top:0;padding:8px 10px;display:flex;gap:8px;align-items:center;background:linear-gradient(180deg,rgba(0,0,0,.65),rgba(0,0,0,.2));z-index:6}
  .pill{padding:2px 6px;border:1px solid var(--ui-border);border-radius:999px;background:var(--ui-pill);font:12px monospace}
  .ok{color:#9fef00}
  #hud{position:fixed;top:8px;right:10px;font:13px monospace;opacity:.92;text-align:right;z-index:6}
  #hud div{margin-bottom:2px}
  #viewport{position:fixed;inset:0;display:flex;align-items:center;justify-content:center}
  canvas{background:#101014;image-rendering:pixelated;border:1px solid #1f2630;box-shadow:0 0 0 1px #000}
  #overlay,#start{position:fixed;inset:0;display:none;align-items:center;justify-content:center;flex-direction:column;background:#000;color:#fff;font-weight:700;z-index:10;text-align:center}
  #start h1 {
  font-size: 48px !important; 
  margin: 0 0 20px 0 !important;
  letter-spacing: 2px;
}

#start > div {
  font-size: 18px !important;
  margin-bottom: 30px !important;
}

#charSelect {
  gap: 40px !important;
  margin-bottom: 30px !important;
}

#charSelect .char {
  padding: 20px 24px !important;
  font-size: 18px !important;
  gap: 12px !important;
}

#charSelect canvas {
  width: 96px !important;
  height: 96px !important;
  border: 2px solid #444 !important;
}

#chosen {
  font-size: 20px !important;
  margin-bottom: 20px !important;
}

#btnStart {
  padding: 16px 32px !important;
  font-size: 18px !important;
}
  #overlay.show,#start.show{display:flex}
  .btn{margin-top:12px;padding:10px 14px;border-radius:8px;border:1px solid #888;background:#151515;color:#fff;cursor:pointer;font:14px/1 monospace}
  #warn{position:fixed;bottom:10px;left:10px;right:10px;padding:10px;border:1px dashed #555;border-radius:8px;background:#111c;display:none;z-index:7}
  #warn.show{display:block}
  #toast{position:fixed;left:50%;transform:translateX(-50%);bottom:18px;background:var(--ui-pill);border:1px solid var(--ui-border);padding:6px 10px;border-radius:8px;opacity:0;transition:.2s;pointer-events:none;font:12px monospace;z-index:7}
  #toast.show{opacity:1}

/* Pantalla de inicio mejorada */
#start {
  background: #0e0f13 !important;
  color: #e6ebef !important;
  font-family: system-ui, Segoe UI, Roboto, Arial !important;
}

#start h1 {
  color: #e6ebef !important;
  font-size: 48px !important;
  margin: 0 0 20px 0 !important;
  letter-spacing: 2px !important;
  text-shadow: none !important;
  font-weight: 700 !important;
}

#start > div {
  color: #e6ebef !important;
  opacity: 0.9 !important;
  font-size: 18px !important;
  margin-bottom: 30px !important;
}

#charSelect .char {
  background: #151515 !important;
  border: 1px solid #888 !important;
  color: #fff !important;
  font-family: system-ui, Segoe UI, Roboto, Arial !important;
  font-size: 18px !important;
  padding: 20px 24px !important;
  gap: 12px !important;
  border-radius: 8px !important;
  cursor: pointer !important;
}

#charSelect .char:hover {
  background: #252525 !important;
  border-color: #aaa !important;
}

#charSelect .char.selected {
  border: 2px solid #9fef00 !important;
  background: #1a1a1a !important;
  box-shadow: 0 0 10px rgba(159, 239, 0, 0.3) !important;
}

#charSelect canvas {
  border: 1px solid #444 !important;
  background: #111 !important;
}

#chosen {
  color: #e6ebef !important;
  font-size: 20px !important;
  margin-bottom: 20px !important;
  opacity: 0.9 !important;
}

#chosenName {
  color: #9fef00 !important;
  font-weight: bold !important;
}

#btnStart {
  background: #151515 !important;
  border: 1px solid #888 !important;
  color: #fff !important;
  font-family: system-ui, Segoe UI, Roboto, Arial !important;
  font-size: 18px !important;
  padding: 16px 32px !important;
  border-radius: 8px !important;
  cursor: pointer !important;
}

#btnStart:hover {
  background: #252525 !important;
}

#btnStart.ready {
  background: linear-gradient(135deg, #4CAF50, #45a049) !important;
  border-color: #4CAF50 !important;
  color: #fff !important;
  animation: pulse 2s infinite !important;
}

@keyframes pulse {
  0% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0.7); }
  70% { box-shadow: 0 0 0 10px rgba(76, 175, 80, 0); }
  100% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0); }
}

/* MEJORAS VISUALES DEL JUEGO */

/* OPCI√ìN 1: Ocultar elementos innecesarios */
#topbar {
  display: none !important;
}

/* OPCI√ìN 3: Mejorar HUD de informaci√≥n (esquina derecha) */
#hud {
  position: fixed;
  top: 15px;
  right: 15px;
  background: rgba(20, 25, 35, 0.95);
  border: 2px solid #4a90e2;
  border-radius: 12px;
  padding: 18px 22px;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  font-size: 13px;
  color: #e6f3ff;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);
  backdrop-filter: blur(15px);
  z-index: 1000;
  min-width: 240px;
  border-image: linear-gradient(135deg, #4a90e2, #357abd) 1;
  opacity: 1;
  text-align: left;
}

#hud div {
  margin-bottom: 10px;
  padding: 6px 0;
  border-bottom: 1px solid rgba(74, 144, 226, 0.3);
  display: flex;
  justify-content: space-between;
  align-items: center;
}

#hud div:last-child {
  border-bottom: none;
  margin-bottom: 0;
}

/* Iconos y valores espec√≠ficos */
#hud div:nth-child(1)::before { content: "üó∫Ô∏è "; }
#hud div:nth-child(2)::before { content: "‚öîÔ∏è "; }
#hud div:nth-child(3)::before { content: "‚ú® "; }

/* Valores destacados */
#biome, #hp, #kills, #boss, #pts, #wname, #wlv {
  color: #00ff88;
  font-weight: 700;
  text-shadow: 0 0 8px rgba(0, 255, 136, 0.6);
  padding: 2px 8px;
  background: rgba(0, 255, 136, 0.1);
  border-radius: 6px;
  border: 1px solid rgba(0, 255, 136, 0.3);
}

/* Estado del boss con color especial */
#boss {
  color: #ff6b35;
  background: rgba(255, 107, 53, 0.1);
  border-color: rgba(255, 107, 53, 0.3);
  text-shadow: 0 0 8px rgba(255, 107, 53, 0.6);
}

/* Arma activa destacada */
#wname {
  color: #ffd700;
  background: rgba(255, 215, 0, 0.1);
  border-color: rgba(255, 215, 0, 0.3);
  text-shadow: 0 0 8px rgba(255, 215, 0, 0.6);
}

/* OPCI√ìN 4: Toast mejorado */
#toast {
  background: rgba(20, 25, 35, 0.95) !important;
  border: 2px solid #00ff88 !important;
  color: #00ff88 !important;
  font-family: 'Segoe UI', sans-serif !important;
  font-weight: 700 !important;
  font-size: 14px !important;
  text-shadow: 0 0 10px rgba(0, 255, 136, 0.8) !important;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6) !important;
  border-radius: 10px !important;
  padding: 14px 20px !important;
  backdrop-filter: blur(15px) !important;
}

/* Canvas con borde mejorado */
canvas {
  border: 3px solid #4a90e2 !important;
  border-radius: 8px !important;
  box-shadow: 0 0 20px rgba(74, 144, 226, 0.4) !important;
}

/* Overlay mejorado */
#overlay {
  background: linear-gradient(135deg, rgba(10, 10, 10, 0.95), rgba(20, 25, 35, 0.95)) !important;
  backdrop-filter: blur(10px) !important;
}

#overlay-text {
  color: #ff6b35 !important;
  text-shadow: 0 0 20px rgba(255, 107, 53, 0.8) !important;
  font-family: 'Segoe UI', sans-serif !important;
}

#overlay-btn {
  background: rgba(20, 25, 35, 0.9) !important;
  border: 2px solid #4a90e2 !important;
  color: #e6f3ff !important;
  font-family: 'Segoe UI', sans-serif !important;
  border-radius: 8px !important;
  transition: all 0.3s ease !important;
}

#overlay-btn:hover {
  border-color: #00ff88 !important;
  color: #00ff88 !important;
  box-shadow: 0 0 15px rgba(0, 255, 136, 0.5) !important;
}

/* Efectos hover para el HUD */
#hud:hover {
  border-color: #00ff88;
  box-shadow: 0 8px 40px rgba(0, 255, 136, 0.3);
  transform: translateY(-2px);
  transition: all 0.3s ease;
}

/* Animaci√≥n de entrada para el HUD */
@keyframes slideInRight {
  from {
    opacity: 0;
    transform: translateX(100px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

#hud {
  animation: slideInRight 0.6s ease-out;
}

/* Responsive para pantallas peque√±as */
@media (max-width: 768px) {
  #hud {
    font-size: 11px;
    padding: 12px 16px;
    min-width: 200px;
    top: 10px;
    right: 10px;
  }
  
  canvas {
    border-width: 2px !important;
  }
}

</style>
</head>
<body>
  <!-- TOP -->
  <div id="topbar">
    <div class="pill">WASD/‚Üê‚Üí‚Üë‚Üì Move</div>
    <div class="pill">Click shoots ‚Äî 1üî• 2‚ö° 3‚ùÑ 4üåë</div>
    <div class="pill" id="spritesState">Sprites <span id="progress">loading‚Ä¶</span></div>
  </div>
  <div id="hud">
    <div>Map <span id="biome">1</span> ¬∑ Life <span id="hp">100</span></div>
    <div>Kills <span id="kills">0</span>/50 ¬∑ Boss <span id="boss">‚Äî</span></div>
    <div>Essence <span id="pts">0</span> ¬∑ <span id="wname">Fire</span> Lv <span id="wlv">1</span></div>
  </div>

  <!-- VIEWPORT + CANVAS RESPONSIVE -->
  <div id="viewport"><canvas id="game" width="960" height="540"></canvas></div>

  <!-- OVERLAY Muerte / Info -->
  <div id="overlay">
    <div id="overlay-text" style="font-size:28px;letter-spacing:.5px;"></div>
    <div id="overlay-sub" style="opacity:.9;margin-top:6px;"></div>
    <button id="overlay-btn" class="btn">Continue</button>
  </div>

  <!-- START SCREEN: selecci√≥n ANOMAGE / SHRIMP -->
  <div id="start" class="show">
    <h1 style="margin:0 0 6px 0;">ANOMA SURVIVAL</h1>
    <div style="opacity:.9;margin-bottom:10px">Choose your character and press <b>Play</b></div>

    <div id="charSelect" style="display:flex;gap:16px;flex-wrap:wrap;justify-content:center;margin-bottom:10px">
      <button class="char btn" data-hero="anomage" style="display:flex;flex-direction:column;align-items:center;gap:6px">
        <span>ANOMAGE</span>
        <canvas id="prev-anomage" width="64" height="64" style="image-rendering:pixelated;border:1px solid #444;background:#111"></canvas>
      </button>
      <button class="char btn" data-hero="shrimp" style="display:flex;flex-direction:column;align-items:center;gap:6px">
        <span>SHRIMP</span>
        <canvas id="prev-shrimp" width="64" height="64" style="image-rendering:pixelated;border:1px solid #444;background:#111"></canvas>
      </button>
    </div>

    <div id="chosen" style="margin-bottom:6px;opacity:.9">Selected: <b id="chosenName">ANOMAGE</b></div>
    <button id="btnStart" class="btn">Play</button>
  </div>

  <!-- Sprites.json file loader (CORS en file://) -->
  <div id="warn" style="display:none !important;">
    <span>No se pudo cargar <b>assets/Sprites.json</b> (CORS en <code>file://</code>). Usando rutas por defecto.</span>
    <button id="btn-pick" class="btn" style="padding:6px 10px;margin-top:0">Cargar Sprites.json‚Ä¶</button>
    <input id="file-pick" type="file" accept="application/json" style="display:none"/>
  </div>
  <div id="toast"></div>

  <script src="game.js"></script>
  <script src="optimization.js"></script>
</body>
</html>
