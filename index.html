<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<title>Anoma Survival</title>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<style>
  :root { --ui-bg: rgba(0,0,0,.55); --ui-pill:#0b1220; --ui-border:#3b4252; }
  html,body{height:100%;margin:0;background:#0e0f13;color:#e6ebef;font:14px/1.2 system-ui,Segoe UI,Roboto,Arial}
  #topbar{position:fixed;left:0;right:0;top:0;padding:8px 10px;display:flex;gap:8px;align-items:center;background:linear-gradient(180deg,rgba(0,0,0,.65),rgba(0,0,0,.2));z-index:6}
  .pill{padding:2px 6px;border:1px solid var(--ui-border);border-radius:999px;background:var(--ui-pill);font:12px monospace}
  .ok{color:#9fef00}
  #hud{position:fixed;top:8px;right:10px;font:13px monospace;opacity:.92;text-align:right;z-index:6}
  #hud div{margin-bottom:2px}
  #viewport{position:fixed;inset:0;display:flex;align-items:center;justify-content:center}
  canvas{background:#101014;image-rendering:pixelated;border:1px solid #1f2630;box-shadow:0 0 0 1px #000}
  #overlay,#start{position:fixed;inset:0;display:none;align-items:center;justify-content:center;flex-direction:column;background:#000;color:#fff;font-weight:700;z-index:10;text-align:center}
  #start h1 {
  font-size: 48px !important; 
  margin: 0 0 20px 0 !important;
  letter-spacing: 2px;
}

#start > div {
  font-size: 18px !important;
  margin-bottom: 30px !important;
}

#charSelect {
  gap: 40px !important;
  margin-bottom: 30px !important;
}

#charSelect .char {
  padding: 20px 24px !important;
  font-size: 18px !important;
  gap: 12px !important;
}

#charSelect canvas {
  width: 96px !important;
  height: 96px !important;
  border: 2px solid #444 !important;
}

#chosen {
  font-size: 20px !important;
  margin-bottom: 20px !important;
}

#btnStart {
  padding: 16px 32px !important;
  font-size: 18px !important;
}
  #overlay.show,#start.show{display:flex}
  .btn{margin-top:12px;padding:10px 14px;border-radius:8px;border:1px solid #888;background:#151515;color:#fff;cursor:pointer;font:14px/1 monospace}
  #warn{position:fixed;bottom:10px;left:10px;right:10px;padding:10px;border:1px dashed #555;border-radius:8px;background:#111c;display:none;z-index:7}
  #warn.show{display:block}
  #toast{position:fixed;left:50%;transform:translateX(-50%);bottom:18px;background:var(--ui-pill);border:1px solid var(--ui-border);padding:6px 10px;border-radius:8px;opacity:0;transition:.2s;pointer-events:none;font:12px monospace;z-index:7}
  #toast.show{opacity:1}

/* Pantalla de inicio mejorada */
#start {
  background: #0e0f13 !important;
  color: #e6ebef !important;
  font-family: system-ui, Segoe UI, Roboto, Arial !important;
}

#start h1 {
  color: #e6ebef !important;
  font-size: 48px !important;
  margin: 0 0 20px 0 !important;
  letter-spacing: 2px !important;
  text-shadow: none !important;
  font-weight: 700 !important;
}

#start > div {
  color: #e6ebef !important;
  opacity: 0.9 !important;
  font-size: 18px !important;
  margin-bottom: 30px !important;
}

#charSelect .char {
  background: #151515 !important;
  border: 1px solid #888 !important;
  color: #fff !important;
  font-family: system-ui, Segoe UI, Roboto, Arial !important;
  font-size: 18px !important;
  padding: 20px 24px !important;
  gap: 12px !important;
  border-radius: 8px !important;
  cursor: pointer !important;
}

#charSelect .char:hover {
  background: #252525 !important;
  border-color: #aaa !important;
}

#charSelect .char.selected {
  border: 2px solid #9fef00 !important;
  background: #1a1a1a !important;
  box-shadow: 0 0 10px rgba(159, 239, 0, 0.3) !important;
}

#charSelect canvas {
  border: 1px solid #444 !important;
  background: #111 !important;
}

#chosen {
  color: #e6ebef !important;
  font-size: 20px !important;
  margin-bottom: 20px !important;
  opacity: 0.9 !important;
}

#chosenName {
  color: #9fef00 !important;
  font-weight: bold !important;
}

#btnStart {
  background: #151515 !important;
  border: 1px solid #888 !important;
  color: #fff !important;
  font-family: system-ui, Segoe UI, Roboto, Arial !important;
  font-size: 18px !important;
  padding: 16px 32px !important;
  border-radius: 8px !important;
  cursor: pointer !important;
}

#btnStart:hover {
  background: #252525 !important;
}

#btnStart.ready {
  background: linear-gradient(135deg, #4CAF50, #45a049) !important;
  border-color: #4CAF50 !important;
  color: #fff !important;
  animation: pulse 2s infinite !important;
}

@keyframes pulse {
  0% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0.7); }
  70% { box-shadow: 0 0 0 10px rgba(76, 175, 80, 0); }
  100% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0); }
}

/* Reemplazar TODAS las mejoras anteriores con esto - Estilo 16-bit SNES aut√©ntico */

/* Fuente pixel art 16-bit */
@import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

/* Paleta de colores 16-bit SNES */
:root {
  --snes-blue: #0038a8;
  --snes-purple: #7038a8;
  --snes-white: #fcfcfc;
  --snes-yellow: #fcfc00;
  --snes-red: #f83800;
  --snes-green: #00b800;
  --snes-dark: #181818;
  --snes-gray: #9c9c9c;
  --snes-border: #606060;
}

/* Ocultar topbar */
#topbar {
  display: none !important;
}

/* HUD estilo 16-bit SNES */
#hud {
  position: fixed !important;
  top: 8px !important;
  right: 8px !important;
  background: var(--snes-blue) !important;
  border: 2px solid var(--snes-white) !important;
  padding: 8px !important;
  font-family: 'Press Start 2P', monospace !important;
  font-size: 8px !important;
  color: var(--snes-white) !important;
  box-shadow: 2px 2px 0 var(--snes-dark) !important;
  z-index: 1000 !important;
  min-width: 160px !important;
  text-align: left !important;
  opacity: 1 !important;
  backdrop-filter: none !important;
  border-radius: 0 !important;
}

#hud div {
  margin-bottom: 4px !important;
  padding: 2px 0 !important;
  border-bottom: 1px solid var(--snes-gray) !important;
  display: block !important;
  line-height: 12px !important;
}

#hud div:last-child {
  border-bottom: none !important;
  margin-bottom: 0 !important;
}

/* Quitar iconos, solo texto 16-bit */
#hud div::before {
  content: none !important;
}

/* Valores destacados estilo 16-bit */
#biome {
  color: var(--snes-yellow) !important;
  background: none !important;
  border: none !important;
  padding: 0 !important;
  text-shadow: none !important;
  border-radius: 0 !important;
}

#hp {
  color: var(--snes-red) !important;
  background: none !important;
  border: none !important;
  padding: 0 !important;
  text-shadow: none !important;
  border-radius: 0 !important;
}

#kills {
  color: var(--snes-white) !important;
  background: none !important;
  border: none !important;
  padding: 0 !important;
  text-shadow: none !important;
  border-radius: 0 !important;
}

#boss {
  color: var(--snes-red) !important;
  background: none !important;
  border: none !important;
  padding: 0 !important;
  text-shadow: none !important;
  border-radius: 0 !important;
}

#pts {
  color: var(--snes-yellow) !important;
  background: none !important;
  border: none !important;
  padding: 0 !important;
  text-shadow: none !important;
  border-radius: 0 !important;
}

#wname {
  color: var(--snes-green) !important;
  background: none !important;
  border: none !important;
  padding: 0 !important;
  text-shadow: none !important;
  border-radius: 0 !important;
}

#wlv {
  color: var(--snes-white) !important;
  background: none !important;
  border: none !important;
  padding: 0 !important;
  text-shadow: none !important;
  border-radius: 0 !important;
}

/* Canvas estilo 16-bit */
canvas {
  border: 4px solid var(--snes-white) !important;
  border-radius: 0 !important;
  box-shadow: 4px 4px 0 var(--snes-dark) !important;
  image-rendering: pixelated !important;
}

/* Toast estilo 16-bit */
#toast {
  background: var(--snes-purple) !important;
  border: 2px solid var(--snes-white) !important;
  color: var(--snes-white) !important;
  font-family: 'Press Start 2P', monospace !important;
  font-size: 8px !important;
  text-shadow: none !important;
  box-shadow: 2px 2px 0 var(--snes-dark) !important;
  border-radius: 0 !important;
  padding: 8px !important;
  backdrop-filter: none !important;
}

/* Pantalla de inicio 16-bit */
#start {
  background: var(--snes-dark) !important;
  color: var(--snes-white) !important;
  font-family: 'Press Start 2P', monospace !important;
}

#start h1 {
  color: var(--snes-yellow) !important;
  font-size: 24px !important;
  margin: 0 0 16px 0 !important;
  letter-spacing: 1px !important;
  text-shadow: 2px 2px 0 var(--snes-dark) !important;
  font-weight: normal !important;
}

#start > div {
  color: var(--snes-white) !important;
  font-size: 8px !important;
  margin-bottom: 16px !important;
  opacity: 1 !important;
}

#charSelect .char {
  background: var(--snes-blue) !important;
  border: 2px solid var(--snes-white) !important;
  color: var(--snes-white) !important;
  font-family: 'Press Start 2P', monospace !important;
  font-size: 8px !important;
  padding: 12px 16px !important;
  gap: 8px !important;
  border-radius: 0 !important;
  cursor: pointer !important;
  box-shadow: 2px 2px 0 var(--snes-dark) !important;
}

#charSelect .char:hover {
  background: var(--snes-purple) !important;
  border-color: var(--snes-yellow) !important;
  box-shadow: 2px 2px 0 var(--snes-dark) !important;
}

#charSelect .char.selected {
  border: 2px solid var(--snes-yellow) !important;
  background: var(--snes-purple) !important;
  box-shadow: 2px 2px 0 var(--snes-dark) !important;
}

#charSelect canvas {
  border: 2px solid var(--snes-white) !important;
  background: var(--snes-dark) !important;
  box-shadow: 1px 1px 0 var(--snes-gray) !important;
}

#chosen {
  color: var(--snes-white) !important;
  font-size: 8px !important;
  margin-bottom: 16px !important;
  opacity: 1 !important;
}

#chosenName {
  color: var(--snes-yellow) !important;
  font-weight: normal !important;
}

#btnStart {
  background: var(--snes-green) !important;
  border: 2px solid var(--snes-white) !important;
  color: var(--snes-white) !important;
  font-family: 'Press Start 2P', monospace !important;
  font-size: 8px !important;
  padding: 8px 16px !important;
  border-radius: 0 !important;
  cursor: pointer !important;
  box-shadow: 2px 2px 0 var(--snes-dark) !important;
}

#btnStart:hover {
  background: var(--snes-yellow) !important;
  color: var(--snes-dark) !important;
}

#btnStart.ready {
  background: var(--snes-green) !important;
  border-color: var(--snes-white) !important;
  color: var(--snes-white) !important;
  animation: snes-blink 1s infinite !important;
}

@keyframes snes-blink {
  0%, 50% { background: var(--snes-green); }
  51%, 100% { background: var(--snes-yellow); color: var(--snes-dark); }
}

/* Overlay estilo 16-bit */
#overlay {
  background: var(--snes-dark) !important;
  backdrop-filter: none !important;
  font-family: 'Press Start 2P', monospace !important;
}

#overlay-text {
  color: var(--snes-red) !important;
  text-shadow: 2px 2px 0 var(--snes-dark) !important;
  font-family: 'Press Start 2P', monospace !important;
  font-size: 16px !important;
}

#overlay-btn {
  background: var(--snes-blue) !important;
  border: 2px solid var(--snes-white) !important;
  color: var(--snes-white) !important;
  font-family: 'Press Start 2P', monospace !important;
  border-radius: 0 !important;
  font-size: 8px !important;
  padding: 8px 16px !important;
  box-shadow: 2px 2px 0 var(--snes-dark) !important;
}

#overlay-btn:hover {
  background: var(--snes-purple) !important;
  border-color: var(--snes-yellow) !important;
}

/* Quitar todos los efectos modernos */
* {
  backdrop-filter: none !important;
  text-shadow: none !important;
  box-shadow: none !important;
}

#hud, #toast, #charSelect .char, #btnStart, #overlay-btn, canvas {
  box-shadow: 2px 2px 0 var(--snes-dark) !important;
}

canvas {
  box-shadow: 4px 4px 0 var(--snes-dark) !important;
}

/* Animaciones removidas */
#hud {
  animation: none !important;
  transform: none !important;
  transition: none !important;
}

#hud:hover {
  transform: none !important;
  border-color: var(--snes-white) !important;
  box-shadow: 2px 2px 0 var(--snes-dark) !important;
}

/* Responsive 16-bit */
@media (max-width: 768px) {
  #hud {
    font-size: 7px !important;
    padding: 6px !important;
    min-width: 140px !important;
    top: 4px !important;
    right: 4px !important;
  }
  
  canvas {
    border-width: 3px !important;
  }
  
  #start h1 {
    font-size: 20px !important;
  }
}
</style>
</head>
<body>
  <!-- TOP -->
  <div id="topbar">
    <div class="pill">WASD/‚Üê‚Üí‚Üë‚Üì Move</div>
    <div class="pill">Click shoots ‚Äî 1üî• 2‚ö° 3‚ùÑ 4üåë</div>
    <div class="pill" id="spritesState">Sprites <span id="progress">loading‚Ä¶</span></div>
  </div>
  <div id="hud">
    <div>Map <span id="biome">1</span> ¬∑ Life <span id="hp">100</span></div>
    <div>Kills <span id="kills">0</span>/50 ¬∑ Boss <span id="boss">‚Äî</span></div>
    <div>Essence <span id="pts">0</span> ¬∑ <span id="wname">Fire</span> Lv <span id="wlv">1</span></div>
  </div>

  <!-- VIEWPORT + CANVAS RESPONSIVE -->
  <div id="viewport"><canvas id="game" width="960" height="540"></canvas></div>

  <!-- OVERLAY Muerte / Info -->
  <div id="overlay">
    <div id="overlay-text" style="font-size:28px;letter-spacing:.5px;"></div>
    <div id="overlay-sub" style="opacity:.9;margin-top:6px;"></div>
    <button id="overlay-btn" class="btn">Continue</button>
  </div>

  <!-- START SCREEN: selecci√≥n ANOMAGE / SHRIMP -->
  <div id="start" class="show">
    <h1 style="margin:0 0 6px 0;">ANOMA SURVIVAL</h1>
    <div style="opacity:.9;margin-bottom:10px">Choose your character and press <b>Play</b></div>

    <div id="charSelect" style="display:flex;gap:16px;flex-wrap:wrap;justify-content:center;margin-bottom:10px">
      <button class="char btn" data-hero="anomage" style="display:flex;flex-direction:column;align-items:center;gap:6px">
        <span>ANOMAGE</span>
        <canvas id="prev-anomage" width="64" height="64" style="image-rendering:pixelated;border:1px solid #444;background:#111"></canvas>
      </button>
      <button class="char btn" data-hero="shrimp" style="display:flex;flex-direction:column;align-items:center;gap:6px">
        <span>SHRIMP</span>
        <canvas id="prev-shrimp" width="64" height="64" style="image-rendering:pixelated;border:1px solid #444;background:#111"></canvas>
      </button>
    </div>

    <div id="chosen" style="margin-bottom:6px;opacity:.9">Selected: <b id="chosenName">ANOMAGE</b></div>
    <button id="btnStart" class="btn">Play</button>
  </div>

  <!-- Sprites.json file loader (CORS en file://) -->
  <div id="warn" style="display:none !important;">
    <span>No se pudo cargar <b>assets/Sprites.json</b> (CORS en <code>file://</code>). Usando rutas por defecto.</span>
    <button id="btn-pick" class="btn" style="padding:6px 10px;margin-top:0">Cargar Sprites.json‚Ä¶</button>
    <input id="file-pick" type="file" accept="application/json" style="display:none"/>
  </div>
  <div id="toast"></div>

  <script src="game.js"></script>
  <script src="optimization.js"></script>
</body>
</html>

