<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<title>Anoma Survival</title>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<style>
  :root { --ui-bg: rgba(0,0,0,.55); --ui-pill:#0b1220; --ui-border:#3b4252; }
  html,body{height:100%;margin:0;background:#0e0f13;color:#e6ebef;font:14px/1.2 system-ui,Segoe UI,Roboto,Arial}
  #topbar{position:fixed;left:0;right:0;top:0;padding:8px 10px;display:flex;gap:8px;align-items:center;background:linear-gradient(180deg,rgba(0,0,0,.65),rgba(0,0,0,.2));z-index:6}
  .pill{padding:2px 6px;border:1px solid var(--ui-border);border-radius:999px;background:var(--ui-pill);font:12px monospace}
  .ok{color:#9fef00}
  #hud{position:fixed;top:8px;right:10px;font:13px monospace;opacity:.92;text-align:right;z-index:6}
  #hud div{margin-bottom:2px}
  #viewport{position:fixed;inset:0;display:flex;align-items:center;justify-content:center}
  canvas{background:#101014;image-rendering:pixelated;border:1px solid #1f2630;box-shadow:0 0 0 1px #000}
  #overlay,#start{position:fixed;inset:0;display:none;align-items:center;justify-content:center;flex-direction:column;background:#000;color:#fff;font-weight:700;z-index:10;text-align:center}
  #start h1 {
  font-size: 48px !important; 
  margin: 0 0 20px 0 !important;
  letter-spacing: 2px;
}

#start > div {
  font-size: 18px !important;
  margin-bottom: 30px !important;
}

#charSelect {
  gap: 40px !important;
  margin-bottom: 30px !important;
}

#charSelect .char {
  padding: 20px 24px !important;
  font-size: 18px !important;
  gap: 12px !important;
}

#charSelect canvas {
  width: 96px !important;
  height: 96px !important;
  border: 2px solid #444 !important;
}

#chosen {
  font-size: 20px !important;
  margin-bottom: 20px !important;
}

#btnStart {
  padding: 16px 32px !important;
  font-size: 18px !important;
}
  #overlay.show,#start.show{display:flex}
  .btn{margin-top:12px;padding:10px 14px;border-radius:8px;border:1px solid #888;background:#151515;color:#fff;cursor:pointer;font:14px/1 monospace}
  #warn{position:fixed;bottom:10px;left:10px;right:10px;padding:10px;border:1px dashed #555;border-radius:8px;background:#111c;display:none;z-index:7}
  #warn.show{display:block}
  #toast{position:fixed;left:50%;transform:translateX(-50%);bottom:18px;background:var(--ui-pill);border:1px solid var(--ui-border);padding:6px 10px;border-radius:8px;opacity:0;transition:.2s;pointer-events:none;font:12px monospace;z-index:7}
  #toast.show{opacity:1}

/* Pantalla de inicio mejorada */
#start {
  background: #0e0f13 !important;
  color: #e6ebef !important;
  font-family: system-ui, Segoe UI, Roboto, Arial !important;
}

#start h1 {
  color: #e6ebef !important;
  font-size: 48px !important;
  margin: 0 0 20px 0 !important;
  letter-spacing: 2px !important;
  text-shadow: none !important;
  font-weight: 700 !important;
}

#start > div {
  color: #e6ebef !important;
  opacity: 0.9 !important;
  font-size: 18px !important;
  margin-bottom: 30px !important;
}

#charSelect .char {
  background: #151515 !important;
  border: 1px solid #888 !important;
  color: #fff !important;
  font-family: system-ui, Segoe UI, Roboto, Arial !important;
  font-size: 18px !important;
  padding: 20px 24px !important;
  gap: 12px !important;
  border-radius: 8px !important;
  cursor: pointer !important;
}

#charSelect .char:hover {
  background: #252525 !important;
  border-color: #aaa !important;
}

#charSelect .char.selected {
  border: 2px solid #9fef00 !important;
  background: #1a1a1a !important;
  box-shadow: 0 0 10px rgba(159, 239, 0, 0.3) !important;
}

#charSelect canvas {
  border: 1px solid #444 !important;
  background: #111 !important;
}

#chosen {
  color: #e6ebef !important;
  font-size: 20px !important;
  margin-bottom: 20px !important;
  opacity: 0.9 !important;
}

#chosenName {
  color: #9fef00 !important;
  font-weight: bold !important;
}

#btnStart {
  background: #151515 !important;
  border: 1px solid #888 !important;
  color: #fff !important;
  font-family: system-ui, Segoe UI, Roboto, Arial !important;
  font-size: 18px !important;
  padding: 16px 32px !important;
  border-radius: 8px !important;
  cursor: pointer !important;
}

#btnStart:hover {
  background: #252525 !important;
}

#btnStart.ready {
  background: linear-gradient(135deg, #4CAF50, #45a049) !important;
  border-color: #4CAF50 !important;
  color: #fff !important;
  animation: pulse 2s infinite !important;
}

@keyframes pulse {
  0% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0.7); }
  70% { box-shadow: 0 0 0 10px rgba(76, 175, 80, 0); }
  100% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0); }
}

/* Reemplazar toda la secci√≥n de mejoras con esto - Estilo Diablo 2 aut√©ntico */

/* Ocultar topbar */
#topbar {
  display: none !important;
}

/* HUD estilo Diablo 2 - panel superior derecho */
#hud {
  position: fixed !important;
  top: 8px !important;
  right: 8px !important;
  background: linear-gradient(135deg, #2a1f1a 0%, #1a1410 50%, #0f0c08 100%) !important;
  border: 2px solid #8b6914 !important;
  border-radius: 4px !important;
  padding: 8px 12px !important;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif !important;
  font-size: 11px !important;
  color: #d4af37 !important;
  box-shadow: 
    inset 0 1px 0 rgba(139, 105, 20, 0.5),
    0 2px 4px rgba(0, 0, 0, 0.8) !important;
  z-index: 1000 !important;
  min-width: 180px !important;
  text-align: left !important;
  opacity: 1 !important;
}

#hud div {
  margin-bottom: 3px !important;
  padding: 1px 0 !important;
  border-bottom: 1px solid rgba(139, 105, 20, 0.3) !important;
  display: block !important;
  line-height: 14px !important;
}

#hud div:last-child {
  border-bottom: none !important;
  margin-bottom: 0 !important;
}

/* Valores con colores Diablo 2 */
#biome {
  color: #fff !important;
  font-weight: bold !important;
}

#hp {
  color: #ff4444 !important;
  font-weight: bold !important;
}

#kills {
  color: #fff !important;
}

#boss {
  color: #ff8888 !important;
  font-weight: bold !important;
}

#pts {
  color: #d4af37 !important;
  font-weight: bold !important;
}

#wname {
  color: #88ff88 !important;
  font-weight: bold !important;
}

#wlv {
  color: #88ff88 !important;
}

/* Canvas con marco dorado */
canvas {
  border: 3px solid #8b6914 !important;
  border-radius: 0 !important;
  box-shadow: 
    inset 0 0 0 1px #d4af37,
    0 4px 8px rgba(0, 0, 0, 0.6) !important;
}

/* Toast estilo Diablo 2 */
#toast {
  background: linear-gradient(135deg, #2a1f1a 0%, #1a1410 100%) !important;
  border: 2px solid #8b6914 !important;
  color: #d4af37 !important;
  font-family: 'Segoe UI', sans-serif !important;
  font-size: 12px !important;
  font-weight: bold !important;
  box-shadow: 
    inset 0 1px 0 rgba(139, 105, 20, 0.5),
    0 2px 6px rgba(0, 0, 0, 0.8) !important;
  border-radius: 4px !important;
  padding: 8px 12px !important;
}

/* Pantalla de inicio estilo Diablo 2 */
#start {
  background: linear-gradient(135deg, #0f0c08 0%, #1a1410 50%, #2a1f1a 100%) !important;
  color: #d4af37 !important;
  font-family: 'Segoe UI', serif !important;
}

#start h1 {
  color: #d4af37 !important;
  font-size: 42px !important;
  font-weight: bold !important;
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8) !important;
  margin: 0 0 20px 0 !important;
  letter-spacing: 2px !important;
}

#start > div {
  color: #c4a484 !important;
  font-size: 16px !important;
  margin-bottom: 25px !important;
  opacity: 1 !important;
}

#charSelect .char {
  background: linear-gradient(135deg, #2a1f1a 0%, #1a1410 100%) !important;
  border: 2px solid #8b6914 !important;
  color: #d4af37 !important;
  font-family: 'Segoe UI', serif !important;
  font-size: 14px !important;
  font-weight: bold !important;
  padding: 16px 20px !important;
  gap: 10px !important;
  border-radius: 6px !important;
  cursor: pointer !important;
  box-shadow: 
    inset 0 1px 0 rgba(139, 105, 20, 0.5),
    0 2px 4px rgba(0, 0, 0, 0.6) !important;
  transition: all 0.2s ease !important;
}

#charSelect .char:hover {
  background: linear-gradient(135deg, #3a2f2a 0%, #2a1f1a 100%) !important;
  border-color: #d4af37 !important;
  box-shadow: 
    inset 0 1px 0 rgba(212, 175, 55, 0.3),
    0 0 8px rgba(212, 175, 55, 0.4) !important;
}

#charSelect .char.selected {
  border: 2px solid #d4af37 !important;
  background: linear-gradient(135deg, #3a2f1a 0%, #2a1f0a 100%) !important;
  box-shadow: 
    inset 0 1px 0 rgba(212, 175, 55, 0.5),
    0 0 12px rgba(212, 175, 55, 0.6) !important;
}

#charSelect canvas {
  border: 2px solid #8b6914 !important;
  background: #0f0c08 !important;
  box-shadow: inset 0 0 4px rgba(0, 0, 0, 0.8) !important;
}

#chosen {
  color: #c4a484 !important;
  font-size: 16px !important;
  margin-bottom: 20px !important;
  opacity: 1 !important;
}

#chosenName {
  color: #d4af37 !important;
  font-weight: bold !important;
}

#btnStart {
  background: linear-gradient(135deg, #2a1f1a 0%, #1a1410 100%) !important;
  border: 2px solid #8b6914 !important;
  color: #d4af37 !important;
  font-family: 'Segoe UI', serif !important;
  font-size: 14px !important;
  font-weight: bold !important;
  padding: 12px 24px !important;
  border-radius: 6px !important;
  cursor: pointer !important;
  box-shadow: 
    inset 0 1px 0 rgba(139, 105, 20, 0.5),
    0 2px 4px rgba(0, 0, 0, 0.6) !important;
  transition: all 0.2s ease !important;
}

#btnStart:hover {
  background: linear-gradient(135deg, #3a2f2a 0%, #2a1f1a 100%) !important;
  border-color: #d4af37 !important;
  box-shadow: 
    inset 0 1px 0 rgba(212, 175, 55, 0.3),
    0 0 8px rgba(212, 175, 55, 0.4) !important;
}

#btnStart.ready {
  background: linear-gradient(135deg, #4a3f2a 0%, #3a2f1a 100%) !important;
  border-color: #d4af37 !important;
  color: #fff !important;
  box-shadow: 
    inset 0 1px 0 rgba(212, 175, 55, 0.5),
    0 0 12px rgba(212, 175, 55, 0.6) !important;
  animation: diabloGlow 2s ease-in-out infinite !important;
}

@keyframes diabloGlow {
  0%, 100% { 
    box-shadow: 
      inset 0 1px 0 rgba(212, 175, 55, 0.5),
      0 0 12px rgba(212, 175, 55, 0.6);
  }
  50% { 
    box-shadow: 
      inset 0 1px 0 rgba(212, 175, 55, 0.7),
      0 0 20px rgba(212, 175, 55, 0.8);
  }
}

/* Overlay estilo Diablo 2 */
#overlay {
  background: linear-gradient(135deg, rgba(15, 12, 8, 0.95) 0%, rgba(26, 20, 16, 0.95) 100%) !important;
  font-family: 'Segoe UI', serif !important;
}

#overlay-text {
  color: #ff4444 !important;
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8) !important;
  font-family: 'Segoe UI', serif !important;
  font-weight: bold !important;
}

#overlay-btn {
  background: linear-gradient(135deg, #2a1f1a 0%, #1a1410 100%) !important;
  border: 2px solid #8b6914 !important;
  color: #d4af37 !important;
  font-family: 'Segoe UI', serif !important;
  border-radius: 6px !important;
  font-size: 12px !important;
  font-weight: bold !important;
  padding: 8px 16px !important;
  box-shadow: 
    inset 0 1px 0 rgba(139, 105, 20, 0.5),
    0 2px 4px rgba(0, 0, 0, 0.6) !important;
}

#overlay-btn:hover {
  background: linear-gradient(135deg, #3a2f2a 0%, #2a1f1a 100%) !important;
  border-color: #d4af37 !important;
  box-shadow: 
    inset 0 1px 0 rgba(212, 175, 55, 0.3),
    0 0 8px rgba(212, 175, 55, 0.4) !important;
}

/* Responsive */
@media (max-width: 768px) {
  #hud {
    font-size: 10px !important;
    padding: 6px 10px !important;
    min-width: 160px !important;
    top: 4px !important;
    right: 4px !important;
  }
  
  #start h1 {
    font-size: 32px !important;
  }
  
  #charSelect .char {
    font-size: 12px !important;
    padding: 12px 16px !important;
  }
}
</style>
</head>
<body>
  <!-- TOP -->
  <div id="topbar">
    <div class="pill">WASD/‚Üê‚Üí‚Üë‚Üì Move</div>
    <div class="pill">Click shoots ‚Äî 1üî• 2‚ö° 3‚ùÑ 4üåë</div>
    <div class="pill" id="spritesState">Sprites <span id="progress">loading‚Ä¶</span></div>
  </div>
  <div id="hud">
    <div>Map <span id="biome">1</span> ¬∑ Life <span id="hp">100</span></div>
    <div>Kills <span id="kills">0</span>/50 ¬∑ Boss <span id="boss">‚Äî</span></div>
    <div>Essence <span id="pts">0</span> ¬∑ <span id="wname">Fire</span> Lv <span id="wlv">1</span></div>
  </div>

  <!-- VIEWPORT + CANVAS RESPONSIVE -->
  <div id="viewport"><canvas id="game" width="960" height="540"></canvas></div>

  <!-- OVERLAY Muerte / Info -->
  <div id="overlay">
    <div id="overlay-text" style="font-size:28px;letter-spacing:.5px;"></div>
    <div id="overlay-sub" style="opacity:.9;margin-top:6px;"></div>
    <button id="overlay-btn" class="btn">Continue</button>
  </div>

  <!-- START SCREEN: selecci√≥n ANOMAGE / SHRIMP -->
  <div id="start" class="show">
    <h1 style="margin:0 0 6px 0;">ANOMA SURVIVAL</h1>
    <div style="opacity:.9;margin-bottom:10px">Choose your character and press <b>Play</b></div>

    <div id="charSelect" style="display:flex;gap:16px;flex-wrap:wrap;justify-content:center;margin-bottom:10px">
      <button class="char btn" data-hero="anomage" style="display:flex;flex-direction:column;align-items:center;gap:6px">
        <span>ANOMAGE</span>
        <canvas id="prev-anomage" width="64" height="64" style="image-rendering:pixelated;border:1px solid #444;background:#111"></canvas>
      </button>
      <button class="char btn" data-hero="shrimp" style="display:flex;flex-direction:column;align-items:center;gap:6px">
        <span>SHRIMP</span>
        <canvas id="prev-shrimp" width="64" height="64" style="image-rendering:pixelated;border:1px solid #444;background:#111"></canvas>
      </button>
    </div>

    <div id="chosen" style="margin-bottom:6px;opacity:.9">Selected: <b id="chosenName">ANOMAGE</b></div>
    <button id="btnStart" class="btn">Play</button>
  </div>

  <!-- Sprites.json file loader (CORS en file://) -->
  <div id="warn" style="display:none !important;">
    <span>No se pudo cargar <b>assets/Sprites.json</b> (CORS en <code>file://</code>). Usando rutas por defecto.</span>
    <button id="btn-pick" class="btn" style="padding:6px 10px;margin-top:0">Cargar Sprites.json‚Ä¶</button>
    <input id="file-pick" type="file" accept="application/json" style="display:none"/>
  </div>
  <div id="toast"></div>

  <script src="game.js"></script>
  <script src="optimization.js"></script>
</body>
</html>


